{% extends 'layout.html' %}

{% block content %}
<div class="dashboard-header">
    <h1>Welcome back, {{ session['username'] }}!</h1>
    <p class="text-muted">Manage your spending and track your budget.</p>
</div>

<div class="stats-grid">
    <div class="card">
        <h3>Total Expenses</h3>
        <p class="total-amount">${{ "%.2f"|format(total) }}</p>
    </div>
    
    <div class="card">
        <h3>Categories Tracked</h3>
        <p class="total-amount">{{ summary|length }}</p>
    </div>
</div>

<div class="dashboard-grid">
    <section class="form-card">
        <h3>Add New Expense</h3>
        <form action="{{ url_for('add_expense') }}" method="POST">
            <div class="form-group">
                <label>Amount ($)</label>
                <input type="number" step="0.01" name="amount" placeholder="0.00" required>
            </div>
            
            <div class="form-group">
                <label>Category</label>
                <select name="category" required>
                    <option value="Food">Food</option>
                    <option value="Transport">Transport</option>
                    <option value="Rent">Rent</option>
                    <option value="Entertainment">Entertainment</option>
                    <option value="Shopping">Shopping</option>
                    <option value="Others">Others</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Date</label>
                <input type="date" name="date" required>
            </div>
            
            <div class="form-group">
                <label>Description</label>
                <textarea name="description" rows="2" placeholder="What was this for?"></textarea>
            </div>
            
            <button type="submit" class="btn btn-primary">Save Expense</button>
        </form>
    </section>

    <section class="list-card">
        <h3>Recent Transactions</h3>
        <div class="table-container">
            {% if expenses %}
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Category</th>
                        <th>Description</th>
                        <th>Amount</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for expense in expenses %}
                    <tr>
                        <td>{{ expense.expense_date }}</td>
                        <td><span class="category-badge">{{ expense.category }}</span></td>
                        <td>{{ expense.description or '-' }}</td>
                        <td><strong>${{ "%.2f"|format(expense.amount) }}</strong></td>
                        <td>
                            <a href="{{ url_for('delete_expense', id=expense.id) }}" class="text-danger">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p style="margin-top: 20px; color: var(--text-muted);">No expenses recorded yet. Start by adding one!</p>
            {% endif %}
        </div>
    </section>
</div>



{% endblock %}